{"ast":null,"code":"import axios from \"axios\";\nconst http = axios.create({\n  baseURL: \"http://127.0.0.1:8000/api/v1/\",\n  headers: {\n    'Authorization': ''\n  }\n});\nhttp.defaults.headers.common['Authorization'] = 'Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ0b2tlbl90eXBlIjoiYWNjZXNzIiwiZXhwIjoxNjk1ODEwNzI5LCJpYXQiOjE2OTU4MDk1MjksImp0aSI6ImRkZDYyMDExZWUzYzQwNjA5ZDE3YmNjOTg3MzFmODIwIiwidXNlcl9pZCI6MX0.rbzObG5Sggo50znRM0dXbtKzBzLDYo0FViwkERGlEKE';\n// http.interceptors.request.use((config) => {\n\n//     const token = localStorage.getItem(\"access_token\");\n\n//     if (token) {\n\n//     }else{\n//       window.location.replace(\"/unauthorized\");\n//     }\n//     return config;\n\n//   });\n\n// http.interceptors.response.use(\n//     (response) => response,\n//     async (error) => {\n//       const originalRequest = error.config;\n\n//      if (error.response === 401) {\n\n//         const accessToken = await refreshAccessToken();\n//         http.defaults.headers.common[\"Authorization\"] =\n//           \"Bearer \" + accessToken;\n//         return http(originalRequest);\n//       } else {\n//         throw error;\n//       }\n//     }\n//   );\nconst refreshAccessToken = async () => {\n  const refreshToken = localStorage.getItem(\"refresh_token\");\n  const data = {\n    refresh: refreshToken\n  };\n  try {\n    const response = await http.post('http://127.0.0.1:8000/api/v1/token/refresh/', data);\n    const accessToken = response.data.access;\n    localStorage.setItem(\"access_token\", accessToken);\n    return accessToken;\n  } catch (err) {\n    if (err.response.status === 401) localStorage.clear();\n    window.location.replace(\"/unauthorized\");\n  }\n};\nexport default http;","map":{"version":3,"names":["axios","http","create","baseURL","headers","defaults","common","refreshAccessToken","refreshToken","localStorage","getItem","data","refresh","response","post","accessToken","access","setItem","err","status","clear","window","location","replace"],"sources":["/home/festin.philip/first_project/src/components/axios.js"],"sourcesContent":["import axios from \"axios\";\nconst http = axios.create({\n  baseURL: \"http://127.0.0.1:8000/api/v1/\",\n  headers: {\n   'Authorization':''\n  }\n});\nhttp.defaults.headers.common['Authorization'] = 'Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ0b2tlbl90eXBlIjoiYWNjZXNzIiwiZXhwIjoxNjk1ODEwNzI5LCJpYXQiOjE2OTU4MDk1MjksImp0aSI6ImRkZDYyMDExZWUzYzQwNjA5ZDE3YmNjOTg3MzFmODIwIiwidXNlcl9pZCI6MX0.rbzObG5Sggo50znRM0dXbtKzBzLDYo0FViwkERGlEKE'\n// http.interceptors.request.use((config) => {\n    \n//     const token = localStorage.getItem(\"access_token\");\n  \n//     if (token) {\n      \n//     }else{\n//       window.location.replace(\"/unauthorized\");\n//     }\n//     return config;\n    \n//   });\n\n\n// http.interceptors.response.use(\n//     (response) => response,\n//     async (error) => {\n//       const originalRequest = error.config;\n     \n//      if (error.response === 401) {\n       \n//         const accessToken = await refreshAccessToken();\n//         http.defaults.headers.common[\"Authorization\"] =\n//           \"Bearer \" + accessToken;\n//         return http(originalRequest);\n//       } else {\n//         throw error;\n//       }\n//     }\n//   );\n  const refreshAccessToken = async () => {\n    const refreshToken = localStorage.getItem(\"refresh_token\");\n    const data = { refresh: refreshToken };\n  \n    try {\n      const response = await http.post('http://127.0.0.1:8000/api/v1/token/refresh/',\n        data\n      );\n      const accessToken = response.data.access;\n      localStorage.setItem(\"access_token\", accessToken);\n      return accessToken;\n    } catch (err) {\n      if(err.response.status===401)\n      localStorage.clear();\n     window.location.replace(\"/unauthorized\");\n    }\n  };\n  export default http;"],"mappings":"AAAA,OAAOA,KAAK,MAAM,OAAO;AACzB,MAAMC,IAAI,GAAGD,KAAK,CAACE,MAAM,CAAC;EACxBC,OAAO,EAAE,+BAA+B;EACxCC,OAAO,EAAE;IACR,eAAe,EAAC;EACjB;AACF,CAAC,CAAC;AACFH,IAAI,CAACI,QAAQ,CAACD,OAAO,CAACE,MAAM,CAAC,eAAe,CAAC,GAAG,6OAA6O;AAC7R;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAGA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACE,MAAMC,kBAAkB,GAAG,MAAAA,CAAA,KAAY;EACrC,MAAMC,YAAY,GAAGC,YAAY,CAACC,OAAO,CAAC,eAAe,CAAC;EAC1D,MAAMC,IAAI,GAAG;IAAEC,OAAO,EAAEJ;EAAa,CAAC;EAEtC,IAAI;IACF,MAAMK,QAAQ,GAAG,MAAMZ,IAAI,CAACa,IAAI,CAAC,6CAA6C,EAC5EH,IACF,CAAC;IACD,MAAMI,WAAW,GAAGF,QAAQ,CAACF,IAAI,CAACK,MAAM;IACxCP,YAAY,CAACQ,OAAO,CAAC,cAAc,EAAEF,WAAW,CAAC;IACjD,OAAOA,WAAW;EACpB,CAAC,CAAC,OAAOG,GAAG,EAAE;IACZ,IAAGA,GAAG,CAACL,QAAQ,CAACM,MAAM,KAAG,GAAG,EAC5BV,YAAY,CAACW,KAAK,CAAC,CAAC;IACrBC,MAAM,CAACC,QAAQ,CAACC,OAAO,CAAC,eAAe,CAAC;EACzC;AACF,CAAC;AACD,eAAetB,IAAI"},"metadata":{},"sourceType":"module","externalDependencies":[]}