{"ast":null,"code":"import { ref, computed, provide, inject, watchEffect, onBeforeUnmount } from \"vue\";\nconst useLayoutProps = {\n  top: {\n    type: Object,\n    default: () => ({\n      order: 2\n    })\n  },\n  right: {\n    type: Object,\n    default: () => ({\n      order: 1\n    })\n  },\n  left: {\n    type: Object,\n    default: () => ({\n      order: 1\n    })\n  },\n  bottom: {\n    type: Object,\n    default: () => ({\n      order: 2\n    })\n  }\n};\nconst VaLayoutKey = \"VaLayout\";\nconst useLayout = props => {\n  const items = ref({\n    top: null,\n    right: null,\n    bottom: null,\n    left: null\n  });\n  const paddings = computed(() => {\n    const {\n      top,\n      right,\n      bottom,\n      left\n    } = items.value;\n    const {\n      top: topConfig,\n      right: rightConfig,\n      bottom: bottomConfig,\n      left: leftConfig\n    } = props;\n    return {\n      top: top && !topConfig.absolute ? top.sizes.height : 0,\n      right: right && !rightConfig.absolute ? right.sizes.width : 0,\n      bottom: bottom && !bottomConfig.absolute ? bottom.sizes.height : 0,\n      left: left && !leftConfig.absolute ? left.sizes.width : 0\n    };\n  });\n  const orders = computed(() => ({\n    top: props.top.order || 0,\n    right: props.right.order || 0,\n    bottom: props.bottom.order || 0,\n    left: props.left.order || 0\n  }));\n  provide(VaLayoutKey, {\n    items,\n    paddings,\n    orders\n  });\n};\nconst useFixedLayoutChild = (area, sizes) => {\n  const layout = inject(VaLayoutKey, null);\n  if (!layout) {\n    throw new Error(\"VaLayoutChild must be used inside VaLayout\");\n  }\n  watchEffect(() => {\n    if (sizes.value) {\n      layout.items.value[area] = {\n        sizes: sizes.value\n      };\n    } else {\n      layout.items.value[area] = null;\n    }\n  });\n  onBeforeUnmount(() => {\n    layout.items.value[area] = null;\n  });\n  return {\n    paddings: computed(() => {\n      return Object.keys(layout.paddings.value).reduce((acc, key) => {\n        if (layout.orders.value[key] > layout.orders.value[area]) {\n          acc[key] = layout.paddings.value[key];\n        }\n        return acc;\n      }, {});\n    })\n  };\n};\nexport { useLayout as a, useFixedLayoutChild as b, useLayoutProps as u };","map":{"version":3,"names":["useLayoutProps","top","type","Object","default","order","right","left","bottom","VaLayoutKey","useLayout","props","items","ref","paddings","computed","value","topConfig","rightConfig","bottomConfig","leftConfig","absolute","sizes","height","width","orders","provide","useFixedLayoutChild","area","layout","inject","Error","watchEffect","onBeforeUnmount","keys","reduce","acc","key"],"sources":["../../../../../../src/components/va-layout/hooks/useLayout.ts"],"sourcesContent":["import { ComputedRef, ExtractPropTypes, InjectionKey, PropType, Ref, computed, inject, onBeforeUnmount, provide, ref, watchEffect } from 'vue'\nimport { AreaName } from './useGridTemplateArea'\n\n// Unwrap type, e.g.: removes name from type alias and returns the type\ntype UnwrapType<T> = true extends boolean ? T : never\n\nexport type AreaConfig = UnwrapType<{\n  absolute?: boolean,\n  order?: number,\n  fixed?: boolean,\n  overlay?: boolean,\n}>\n\nexport const useLayoutProps = {\n  top: {\n    type: Object as PropType<AreaConfig>,\n    default: () => ({ order: 2 }),\n  },\n  right: {\n    type: Object as PropType<AreaConfig>,\n    default: () => ({ order: 1 }),\n  },\n  left: {\n    type: Object as PropType<AreaConfig>,\n    default: () => ({ order: 1 }),\n  },\n  bottom: {\n    type: Object as PropType<AreaConfig>,\n    default: () => ({ order: 2 }),\n  },\n}\n\nexport type LayoutProps = ExtractPropTypes<typeof useLayoutProps>\n\ntype LayoutItem = {\n  sizes: DOMRectReadOnly,\n}\n\nconst VaLayoutKey = 'VaLayout' as unknown as InjectionKey<{\n  items: Ref<Record<AreaName, LayoutItem | null>>,\n  paddings: ComputedRef<Record<AreaName, number>>,\n  orders: ComputedRef<Record<AreaName, number>>,\n}>\n\nexport const useLayout = (props: ExtractPropTypes<typeof useLayoutProps>) => {\n  const items = ref<Record<AreaName, LayoutItem | null>>({\n    top: null,\n    right: null,\n    bottom: null,\n    left: null,\n  })\n\n  const paddings = computed(() => {\n    const { top, right, bottom, left } = items.value\n    const { top: topConfig, right: rightConfig, bottom: bottomConfig, left: leftConfig } = props\n\n    return {\n      top: top && !topConfig.absolute ? top.sizes.height : 0,\n      right: right && !rightConfig.absolute ? right.sizes.width : 0,\n      bottom: bottom && !bottomConfig.absolute ? bottom.sizes.height : 0,\n      left: left && !leftConfig.absolute ? left.sizes.width : 0,\n    }\n  })\n\n  const orders = computed(() => ({\n    top: props.top.order || 0,\n    right: props.right.order || 0,\n    bottom: props.bottom.order || 0,\n    left: props.left.order || 0,\n  }))\n\n  provide(VaLayoutKey, {\n    items,\n    paddings,\n    orders,\n  })\n}\n\nexport const useFixedLayoutChild = (area: AreaName, sizes: Ref<DOMRectReadOnly | null>) => {\n  const layout = inject(VaLayoutKey, null)\n\n  if (!layout) {\n    throw new Error('VaLayoutChild must be used inside VaLayout')\n  }\n\n  watchEffect(() => {\n    if (sizes.value) {\n      layout.items.value[area] = {\n        sizes: sizes.value,\n      }\n    } else {\n      layout.items.value[area] = null\n    }\n  })\n\n  onBeforeUnmount(() => {\n    layout.items.value[area] = null\n  })\n\n  return {\n    paddings: computed(() => {\n      return Object\n        .keys(layout.paddings.value)\n        .reduce((acc, key) => {\n          if (layout.orders.value[key as AreaName] > layout.orders.value[area]) {\n            acc[key as AreaName] = layout.paddings.value[key as AreaName]\n          }\n          return acc\n        }, {} as Record<AreaName, number>)\n    }),\n  }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}