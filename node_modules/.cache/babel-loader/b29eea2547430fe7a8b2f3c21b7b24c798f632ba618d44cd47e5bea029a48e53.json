{"ast":null,"code":"import axios from \"axios\";\nconst http = axios.create({\n  baseURL: \"http://127.0.0.1:8000/api/v1/\"\n});\nhttp.interceptors.request.use(config => {\n  const token = localStorage.getItem(\"access_token\");\n  if (token) {\n    http.headers = 'Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ0b2tlbl90eXBlIjoiYWNjZXNzIiwiZXhwIjoxNjk1ODEwNzI5LCJpYXQiOjE2OTU4MDk1MjksImp0aSI6ImRkZDYyMDExZWUzYzQwNjA5ZDE3YmNjOTg3MzFmODIwIiwidXNlcl9pZCI6MX0.rbzObG5Sggo50znRM0dXbtKzBzLDYo0FViwkERGlEKE';\n  } else {\n    window.location.replace(\"/unauthorized\");\n  }\n  return config;\n});\nhttp.interceptors.response.use(response => response, async error => {\n  const originalRequest = error.config;\n  if (error.response === 401) {\n    const accessToken = await refreshAccessToken();\n    http.defaults.headers.common[\"Authorization\"] = \"Bearer \" + accessToken;\n    return http(originalRequest);\n  } else {\n    throw error;\n  }\n});\nconst refreshAccessToken = async () => {\n  const refreshToken = localStorage.getItem(\"refresh_token\");\n  const data = {\n    refresh: refreshToken\n  };\n  try {\n    const response = await http.post('http://127.0.0.1:8000/api/v1/token/refresh/', data);\n    const accessToken = response.data.access;\n    localStorage.setItem(\"access_token\", accessToken);\n    return accessToken;\n  } catch (err) {\n    if (err.response.status === 401) localStorage.clear();\n    window.location.replace(\"/unauthorized\");\n  }\n};\nexport default http;","map":{"version":3,"names":["axios","http","create","baseURL","interceptors","request","use","config","token","localStorage","getItem","headers","window","location","replace","response","error","originalRequest","accessToken","refreshAccessToken","defaults","common","refreshToken","data","refresh","post","access","setItem","err","status","clear"],"sources":["/home/festin.philip/first_project/src/components/axios.js"],"sourcesContent":["import axios from \"axios\";\nconst http = axios.create({\n  baseURL: \"http://127.0.0.1:8000/api/v1/\",\n\n});\n\nhttp.interceptors.request.use((config) => {\n    const token = localStorage.getItem(\"access_token\");\n  \n    if (token) {\n        http.headers = 'Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ0b2tlbl90eXBlIjoiYWNjZXNzIiwiZXhwIjoxNjk1ODEwNzI5LCJpYXQiOjE2OTU4MDk1MjksImp0aSI6ImRkZDYyMDExZWUzYzQwNjA5ZDE3YmNjOTg3MzFmODIwIiwidXNlcl9pZCI6MX0.rbzObG5Sggo50znRM0dXbtKzBzLDYo0FViwkERGlEKE'\n    }else{\n      window.location.replace(\"/unauthorized\");\n    }\n    return config;\n    \n  });\n\n\nhttp.interceptors.response.use(\n    (response) => response,\n    async (error) => {\n      const originalRequest = error.config;\n     \n     if (error.response === 401) {\n       \n        const accessToken = await refreshAccessToken();\n        http.defaults.headers.common[\"Authorization\"] =\n          \"Bearer \" + accessToken;\n        return http(originalRequest);\n      } else {\n        throw error;\n      }\n    }\n  );\n  const refreshAccessToken = async () => {\n    const refreshToken = localStorage.getItem(\"refresh_token\");\n    const data = { refresh: refreshToken };\n  \n    try {\n      const response = await http.post('http://127.0.0.1:8000/api/v1/token/refresh/',\n        data\n      );\n      const accessToken = response.data.access;\n      localStorage.setItem(\"access_token\", accessToken);\n      return accessToken;\n    } catch (err) {\n      if(err.response.status===401)\n      localStorage.clear();\n     window.location.replace(\"/unauthorized\");\n    }\n  };\n  export default http;"],"mappings":"AAAA,OAAOA,KAAK,MAAM,OAAO;AACzB,MAAMC,IAAI,GAAGD,KAAK,CAACE,MAAM,CAAC;EACxBC,OAAO,EAAE;AAEX,CAAC,CAAC;AAEFF,IAAI,CAACG,YAAY,CAACC,OAAO,CAACC,GAAG,CAAEC,MAAM,IAAK;EACtC,MAAMC,KAAK,GAAGC,YAAY,CAACC,OAAO,CAAC,cAAc,CAAC;EAElD,IAAIF,KAAK,EAAE;IACPP,IAAI,CAACU,OAAO,GAAG,6OAA6O;EAChQ,CAAC,MAAI;IACHC,MAAM,CAACC,QAAQ,CAACC,OAAO,CAAC,eAAe,CAAC;EAC1C;EACA,OAAOP,MAAM;AAEf,CAAC,CAAC;AAGJN,IAAI,CAACG,YAAY,CAACW,QAAQ,CAACT,GAAG,CACzBS,QAAQ,IAAKA,QAAQ,EACtB,MAAOC,KAAK,IAAK;EACf,MAAMC,eAAe,GAAGD,KAAK,CAACT,MAAM;EAErC,IAAIS,KAAK,CAACD,QAAQ,KAAK,GAAG,EAAE;IAEzB,MAAMG,WAAW,GAAG,MAAMC,kBAAkB,CAAC,CAAC;IAC9ClB,IAAI,CAACmB,QAAQ,CAACT,OAAO,CAACU,MAAM,CAAC,eAAe,CAAC,GAC3C,SAAS,GAAGH,WAAW;IACzB,OAAOjB,IAAI,CAACgB,eAAe,CAAC;EAC9B,CAAC,MAAM;IACL,MAAMD,KAAK;EACb;AACF,CACF,CAAC;AACD,MAAMG,kBAAkB,GAAG,MAAAA,CAAA,KAAY;EACrC,MAAMG,YAAY,GAAGb,YAAY,CAACC,OAAO,CAAC,eAAe,CAAC;EAC1D,MAAMa,IAAI,GAAG;IAAEC,OAAO,EAAEF;EAAa,CAAC;EAEtC,IAAI;IACF,MAAMP,QAAQ,GAAG,MAAMd,IAAI,CAACwB,IAAI,CAAC,6CAA6C,EAC5EF,IACF,CAAC;IACD,MAAML,WAAW,GAAGH,QAAQ,CAACQ,IAAI,CAACG,MAAM;IACxCjB,YAAY,CAACkB,OAAO,CAAC,cAAc,EAAET,WAAW,CAAC;IACjD,OAAOA,WAAW;EACpB,CAAC,CAAC,OAAOU,GAAG,EAAE;IACZ,IAAGA,GAAG,CAACb,QAAQ,CAACc,MAAM,KAAG,GAAG,EAC5BpB,YAAY,CAACqB,KAAK,CAAC,CAAC;IACrBlB,MAAM,CAACC,QAAQ,CAACC,OAAO,CAAC,eAAe,CAAC;EACzC;AACF,CAAC;AACD,eAAeb,IAAI"},"metadata":{},"sourceType":"module","externalDependencies":[]}