{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport axios from \"axios\";\naxios.defaults.baseURL = \"http://127.0.0.1:8000/api/v1/\";\nconst token = localStorage.getItem('access_token');\nif (token) {\n  axios.defaults.headers.common['Authorization'] = 'Bearer ' + token;\n} else {\n  router.push('/');\n}\n// axios.interceptors.request.use(config => {\n\n//     const token = localStorage.getItem('access_token');\n\n//     if (token) {\n//          axios.defaults.headers.common['Authorization'] = 'Bearer '+token\n\n//     }else{\n//       window.location.replace(\"/unauthorized\");\n//     }\n//     return config;\n\n//   });\n\naxios.interceptors.response.use(response => response, async error => {\n  const originalRequest = error.config;\n\n  //  if (error.response === 401) {\n\n  const accessToken = await refreshAccessToken();\n  axios.defaults.headers.common[\"Authorization\"] = \"Bearer \" + accessToken;\n  return axios(originalRequest);\n}\n//   else {\n//     throw error;\n//   }\n// }\n);\n\nconst refreshAccessToken = async () => {\n  const refreshToken = localStorage.getItem(\"refresh_token\");\n  const data = {\n    refresh: refreshToken\n  };\n  try {\n    const response = await axios.post('axios://127.0.0.1:8000/api/v1/token/refresh/', data);\n    const accessToken = response.data.access;\n    localStorage.setItem(\"access_token\", accessToken);\n    return accessToken;\n  } catch (err) {\n    if (err.response.status === 401) localStorage.clear();\n    window.location.replace(\"/unauthorized\");\n  }\n};\nexport default axios;","map":{"version":3,"names":["axios","defaults","baseURL","token","localStorage","getItem","headers","common","router","push","interceptors","response","use","error","originalRequest","config","accessToken","refreshAccessToken","refreshToken","data","refresh","post","access","setItem","err","status","clear","window","location","replace"],"sources":["/home/festin.philip/first_project/src/components/axios.js"],"sourcesContent":["import axios from \"axios\";\n\naxios.defaults.baseURL=\"http://127.0.0.1:8000/api/v1/\"\nconst token = localStorage.getItem('access_token');\n  \n    if (token) {\n         axios.defaults.headers.common['Authorization'] = 'Bearer '+token\n    }\n    else{\n        router.push('/')\n      }\n// axios.interceptors.request.use(config => {\n    \n//     const token = localStorage.getItem('access_token');\n  \n//     if (token) {\n//          axios.defaults.headers.common['Authorization'] = 'Bearer '+token\n\n//     }else{\n//       window.location.replace(\"/unauthorized\");\n//     }\n//     return config;\n    \n//   });\n\n\naxios.interceptors.response.use(\n    (response) => response,\n    async (error) => {\n      const originalRequest = error.config;\n     \n    //  if (error.response === 401) {\n       \n        const accessToken = await refreshAccessToken();\n        axios.defaults.headers.common[\"Authorization\"] =\n          \"Bearer \" + accessToken;\n        return axios(originalRequest);\n      } \n    //   else {\n    //     throw error;\n    //   }\n    // }\n  );\n  const refreshAccessToken = async () => {\n    const refreshToken = localStorage.getItem(\"refresh_token\");\n    const data = { refresh: refreshToken };\n  \n    try {\n      const response = await axios.post('axios://127.0.0.1:8000/api/v1/token/refresh/',\n        data\n      );\n      const accessToken = response.data.access;\n      localStorage.setItem(\"access_token\", accessToken);\n      return accessToken;\n    } catch (err) {\n      if(err.response.status===401)\n      localStorage.clear();\n     window.location.replace(\"/unauthorized\");\n    }\n  };\n  export default axios;"],"mappings":";AAAA,OAAOA,KAAK,MAAM,OAAO;AAEzBA,KAAK,CAACC,QAAQ,CAACC,OAAO,GAAC,+BAA+B;AACtD,MAAMC,KAAK,GAAGC,YAAY,CAACC,OAAO,CAAC,cAAc,CAAC;AAE9C,IAAIF,KAAK,EAAE;EACNH,KAAK,CAACC,QAAQ,CAACK,OAAO,CAACC,MAAM,CAAC,eAAe,CAAC,GAAG,SAAS,GAACJ,KAAK;AACrE,CAAC,MACG;EACAK,MAAM,CAACC,IAAI,CAAC,GAAG,CAAC;AAClB;AACN;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAGAT,KAAK,CAACU,YAAY,CAACC,QAAQ,CAACC,GAAG,CAC1BD,QAAQ,IAAKA,QAAQ,EACtB,MAAOE,KAAK,IAAK;EACf,MAAMC,eAAe,GAAGD,KAAK,CAACE,MAAM;;EAEtC;;EAEI,MAAMC,WAAW,GAAG,MAAMC,kBAAkB,CAAC,CAAC;EAC9CjB,KAAK,CAACC,QAAQ,CAACK,OAAO,CAACC,MAAM,CAAC,eAAe,CAAC,GAC5C,SAAS,GAAGS,WAAW;EACzB,OAAOhB,KAAK,CAACc,eAAe,CAAC;AAC/B;AACF;AACA;AACA;AACA;AACF,CAAC;;AACD,MAAMG,kBAAkB,GAAG,MAAAA,CAAA,KAAY;EACrC,MAAMC,YAAY,GAAGd,YAAY,CAACC,OAAO,CAAC,eAAe,CAAC;EAC1D,MAAMc,IAAI,GAAG;IAAEC,OAAO,EAAEF;EAAa,CAAC;EAEtC,IAAI;IACF,MAAMP,QAAQ,GAAG,MAAMX,KAAK,CAACqB,IAAI,CAAC,8CAA8C,EAC9EF,IACF,CAAC;IACD,MAAMH,WAAW,GAAGL,QAAQ,CAACQ,IAAI,CAACG,MAAM;IACxClB,YAAY,CAACmB,OAAO,CAAC,cAAc,EAAEP,WAAW,CAAC;IACjD,OAAOA,WAAW;EACpB,CAAC,CAAC,OAAOQ,GAAG,EAAE;IACZ,IAAGA,GAAG,CAACb,QAAQ,CAACc,MAAM,KAAG,GAAG,EAC5BrB,YAAY,CAACsB,KAAK,CAAC,CAAC;IACrBC,MAAM,CAACC,QAAQ,CAACC,OAAO,CAAC,eAAe,CAAC;EACzC;AACF,CAAC;AACD,eAAe7B,KAAK"},"metadata":{},"sourceType":"module","externalDependencies":[]}