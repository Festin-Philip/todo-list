{"ast":null,"code":"import { watch } from \"vue\";\nconst useAutocompleteProps = {\n  autocomplete: {\n    type: Boolean,\n    default: false\n  }\n};\nconst useAutocomplete = (autocompleteValue, props, value, dropdownShown, getText) => {\n  const getLastOptionText = v => (v == null ? void 0 : v.length) ? getText(v.at(-1)) : \"\";\n  watch(value, (newValue, oldValue) => {\n    if (!props.autocomplete) {\n      return;\n    }\n    const newValueStringConverted = getLastOptionText(newValue);\n    const oldValueStringConverted = getLastOptionText(oldValue);\n    if (newValueStringConverted !== oldValueStringConverted) {\n      autocompleteValue.value = props.multiple ? \"\" : newValueStringConverted;\n      if (!props.multiple) {\n        dropdownShown.value = false;\n      }\n    }\n  });\n  watch(autocompleteValue, newValue => {\n    if (newValue && newValue !== getLastOptionText(value.value)) {\n      dropdownShown.value = true;\n    }\n  });\n  const onDropdownClosed = () => {\n    autocompleteValue.value = props.multiple ? \"\" : getLastOptionText(value.value);\n  };\n  watch(dropdownShown, (newValue, oldValue) => {\n    if (!props.autocomplete) {\n      return;\n    }\n    if (!newValue || oldValue) {\n      onDropdownClosed();\n    }\n  });\n  return autocompleteValue;\n};\nexport { useAutocomplete as a, useAutocompleteProps as u };","map":{"version":3,"names":["useAutocompleteProps","autocomplete","type","Boolean","default","useAutocomplete","autocompleteValue","props","value","dropdownShown","getText","getLastOptionText","v","length","at","watch","newValue","oldValue","newValueStringConverted","oldValueStringConverted","multiple","onDropdownClosed"],"sources":["../../../../../../src/components/va-select/hooks/useAutocomplete.ts"],"sourcesContent":["import { ref, watch, type Ref, type ExtractPropTypes, onMounted } from 'vue'\n\nimport type { SelectOption } from '../types'\n\nexport const useAutocompleteProps = {\n  autocomplete: { type: Boolean, default: false },\n}\n\ntype UseAutocompleteProps = ExtractPropTypes<typeof useAutocompleteProps> & { multiple: boolean }\n\nexport const useAutocomplete = (\n  autocompleteValue: Ref<string>,\n  props: UseAutocompleteProps,\n  value: Ref<SelectOption[]>,\n  dropdownShown: Ref<boolean>,\n  getText: (option: SelectOption) => string,\n) => {\n  const getLastOptionText = (v: SelectOption[]) => v?.length ? getText(v.at(-1)!) : ''\n\n  watch(value, (newValue, oldValue) => {\n    if (!props.autocomplete) { return }\n\n    const newValueStringConverted = getLastOptionText(newValue)\n    const oldValueStringConverted = getLastOptionText(oldValue)\n\n    if (newValueStringConverted !== oldValueStringConverted) {\n      autocompleteValue.value = props.multiple ? '' : newValueStringConverted\n      if (!props.multiple) {\n        dropdownShown.value = false\n      }\n    }\n  })\n\n  watch(autocompleteValue, (newValue) => {\n    if (newValue && newValue !== getLastOptionText(value.value)) {\n      dropdownShown.value = true\n    }\n  })\n\n  const onDropdownClosed = () => {\n    autocompleteValue.value = props.multiple ? '' : getLastOptionText(value.value)\n  }\n\n  watch(dropdownShown, (newValue, oldValue) => {\n    if (!props.autocomplete) { return }\n\n    if (!newValue || oldValue) { onDropdownClosed() }\n  })\n\n  return autocompleteValue\n}\n"],"mappings":";AAIO,MAAMA,oBAAA,GAAuB;EAClCC,YAAA,EAAc;IAAEC,IAAA,EAAMC,OAAA;IAASC,OAAA,EAAS;EAAM;AAChD;AAIO,MAAMC,eAAA,GAAkBA,CAC7BC,iBAAA,EACAC,KAAA,EACAC,KAAA,EACAC,aAAA,EACAC,OAAA,KACG;EACG,MAAAC,iBAAA,GAAqBC,CAAA,KAAsBA,CAAA,oBAAAA,CAAA,CAAGC,MAAA,IAASH,OAAA,CAAQE,CAAA,CAAEE,EAAA,CAAG,EAAE,CAAE,IAAI;EAE5EC,KAAA,CAAAP,KAAA,EAAO,CAACQ,QAAA,EAAUC,QAAA,KAAa;IAC/B,KAACV,KAAA,CAAMN,YAAA,EAAc;MAAE;IAAO;IAE5B,MAAAiB,uBAAA,GAA0BP,iBAAA,CAAkBK,QAAQ;IACpD,MAAAG,uBAAA,GAA0BR,iBAAA,CAAkBM,QAAQ;IAE1D,IAAIC,uBAAA,KAA4BC,uBAAA,EAAyB;MACrCb,iBAAA,CAAAE,KAAA,GAAQD,KAAA,CAAMa,QAAA,GAAW,KAAKF,uBAAA;MAC5C,KAACX,KAAA,CAAMa,QAAA,EAAU;QACnBX,aAAA,CAAcD,KAAA,GAAQ;MACxB;IACF;EAAA,CACD;EAEKO,KAAA,CAAAT,iBAAA,EAAoBU,QAAA,IAAa;IACrC,IAAIA,QAAA,IAAYA,QAAA,KAAaL,iBAAA,CAAkBH,KAAA,CAAMA,KAAK,GAAG;MAC3DC,aAAA,CAAcD,KAAA,GAAQ;IACxB;EAAA,CACD;EAED,MAAMa,gBAAA,GAAmBA,CAAA,KAAM;IAC7Bf,iBAAA,CAAkBE,KAAA,GAAQD,KAAA,CAAMa,QAAA,GAAW,KAAKT,iBAAA,CAAkBH,KAAA,CAAMA,KAAK;EAAA;EAGzEO,KAAA,CAAAN,aAAA,EAAe,CAACO,QAAA,EAAUC,QAAA,KAAa;IACvC,KAACV,KAAA,CAAMN,YAAA,EAAc;MAAE;IAAO;IAE9B,KAACe,QAAA,IAAYC,QAAA,EAAU;MAAmBI,gBAAA;IAAE;EAAA,CACjD;EAEM,OAAAf,iBAAA;AACT"},"metadata":{},"sourceType":"module","externalDependencies":[]}