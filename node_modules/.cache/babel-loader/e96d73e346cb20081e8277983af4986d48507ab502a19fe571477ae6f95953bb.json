{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport axios from \"axios\";\nimport router from \"@/router\";\naxios.defaults.baseURL = \"http://127.0.0.1:8000/api/v1/\";\nconst access = localStorage.getItem(\"access_token\");\naxios.defaults.headers.common['Authorization'] = 'Bearer ' + access;\naxios.interceptors.request.use(config => {\n  const access = localStorage.getItem(\"access_token\");\n  if (access) axios.defaults.headers.common['Authorization'] = 'Bearer ' + access;else router.push('/');\n  return config;\n});\naxios.interceptors.response.use(response => response, async error => {\n  console.log(error);\n  const accessToken = refreshAccessToken();\n  axios.defaults.headers.common[\"Authorization\"] = \"Bearer \" + accessToken;\n  return axios(response);\n});\n\n// export const accessToken = async () => {\n// const access = localStorage.getItem(\"access_token\");\n\n//     if(access)\n//         axios.defaults.headers.common['Authorization'] = 'Bearer '+access\n//     else\n//         router.push('/')\n// }\n\nexport const refreshAccessToken = async () => {\n  const refreshToken = localStorage.getItem(\"refresh_token\");\n  const data = {\n    refresh: refreshToken\n  };\n  try {\n    const response = await axios.post('http://127.0.0.1:8000/api/v1/token/refresh/', data);\n    const accessToken = response.data.access;\n    localStorage.setItem(\"access_token\", accessToken);\n    return accessToken;\n  } catch (err) {\n    localStorage.clear();\n    router.push('/');\n  }\n};\nconst token = localStorage.getItem('access_token');\nif (token) {\n  axios.defaults.headers.common['Authorization'] = 'Bearer ' + token;\n} else {\n  router.push('/');\n}\n\n// axios.interceptors.request.use((req) => {\n\n//     const token = localStorage.getItem('access_token');\n\n//     if (token) {\n//          req.defaults.headers.common['Authorization'] = 'Bearer '+token\n\n//     }else{\n//         router.push('/')\n//     }\n\n//   });\n\n// axios.interceptors.response.use(\n//     (response) => response,\n//     async (error) => {\n//       const originalRequest = error.config;\n\n//     //  if (error.response === 401) {\n\n//         const accessToken = await refreshAccessToken();\n//         axios.defaults.headers.common[\"Authorization\"] =\n//           \"Bearer \" + accessToken;\n//         return axios(originalRequest);\n//       } \n//     //   else {\n//     //     throw error;\n//     //   }\n//     // }\n//   );\n//   const refreshAccessToken = async () => {\n//     const refreshToken = localStorage.getItem(\"refresh_token\");\n//     const data = { refresh: refreshToken };\n\n//     try {\n//       const response = await axios.post('axios://127.0.0.1:8000/api/v1/token/refresh/',\n//         data\n//       );\n//       const accessToken = response.data.access;\n//       localStorage.setItem(\"access_token\", accessToken);\n//       return accessToken;\n//     } catch (err) {\n//       if(err.response.status===401)\n//       localStorage.clear();\n//      window.location.replace(\"/unauthorized\");\n//     }\n//   };\n\nexport default axios;","map":{"version":3,"names":["axios","router","defaults","baseURL","access","localStorage","getItem","headers","common","interceptors","request","use","config","push","response","error","console","log","accessToken","refreshAccessToken","refreshToken","data","refresh","post","setItem","err","clear","token"],"sources":["/home/festin.philip/first_project/src/components/axios.js"],"sourcesContent":["import axios from \"axios\";\nimport router from \"@/router\";\naxios.defaults.baseURL=\"http://127.0.0.1:8000/api/v1/\"\nconst access = localStorage.getItem(\"access_token\");\naxios.defaults.headers.common['Authorization'] = 'Bearer '+access\n\naxios.interceptors.request.use((config) => {\n    const access = localStorage.getItem(\"access_token\");\n\n\n        if(access)\n            axios.defaults.headers.common['Authorization'] = 'Bearer '+access\n        else\n            router.push('/')\n    \n    return config\n  })\n  \n  axios.interceptors.response.use(\n    (response) => response,\n    async (error) => {\n        console.log(error)\n    const accessToken =  refreshAccessToken();\n            axios.defaults.headers.common[\"Authorization\"] =\n              \"Bearer \" + accessToken;\n            return axios(response);\n    \n\n  })\n  \n// export const accessToken = async () => {\n// const access = localStorage.getItem(\"access_token\");\n\n\n//     if(access)\n//         axios.defaults.headers.common['Authorization'] = 'Bearer '+access\n//     else\n//         router.push('/')\n// }\n\n\nexport const refreshAccessToken = async () => {\n        const refreshToken = localStorage.getItem(\"refresh_token\");\n        const data = { refresh: refreshToken };\n      \n        try {\n          const response = await axios.post('http://127.0.0.1:8000/api/v1/token/refresh/',\n            data\n          );\n          const accessToken = response.data.access;\n          localStorage.setItem(\"access_token\", accessToken);\n          return accessToken;\n        } catch (err) {\n         \n          localStorage.clear();\n          router.push('/')\n        }\n      };\n\nconst token = localStorage.getItem('access_token');\n  \n    if (token) {\n         axios.defaults.headers.common['Authorization'] = 'Bearer '+token\n    }\n    else{\n        router.push('/')\n      }\n\n// axios.interceptors.request.use((req) => {\n    \n//     const token = localStorage.getItem('access_token');\n  \n//     if (token) {\n//          req.defaults.headers.common['Authorization'] = 'Bearer '+token\n\n//     }else{\n//         router.push('/')\n//     }\n    \n    \n//   });\n\n\n// axios.interceptors.response.use(\n//     (response) => response,\n//     async (error) => {\n//       const originalRequest = error.config;\n     \n//     //  if (error.response === 401) {\n       \n//         const accessToken = await refreshAccessToken();\n//         axios.defaults.headers.common[\"Authorization\"] =\n//           \"Bearer \" + accessToken;\n//         return axios(originalRequest);\n//       } \n//     //   else {\n//     //     throw error;\n//     //   }\n//     // }\n//   );\n//   const refreshAccessToken = async () => {\n//     const refreshToken = localStorage.getItem(\"refresh_token\");\n//     const data = { refresh: refreshToken };\n  \n//     try {\n//       const response = await axios.post('axios://127.0.0.1:8000/api/v1/token/refresh/',\n//         data\n//       );\n//       const accessToken = response.data.access;\n//       localStorage.setItem(\"access_token\", accessToken);\n//       return accessToken;\n//     } catch (err) {\n//       if(err.response.status===401)\n//       localStorage.clear();\n//      window.location.replace(\"/unauthorized\");\n//     }\n//   };\n\n  export default axios;"],"mappings":";AAAA,OAAOA,KAAK,MAAM,OAAO;AACzB,OAAOC,MAAM,MAAM,UAAU;AAC7BD,KAAK,CAACE,QAAQ,CAACC,OAAO,GAAC,+BAA+B;AACtD,MAAMC,MAAM,GAAGC,YAAY,CAACC,OAAO,CAAC,cAAc,CAAC;AACnDN,KAAK,CAACE,QAAQ,CAACK,OAAO,CAACC,MAAM,CAAC,eAAe,CAAC,GAAG,SAAS,GAACJ,MAAM;AAEjEJ,KAAK,CAACS,YAAY,CAACC,OAAO,CAACC,GAAG,CAAEC,MAAM,IAAK;EACvC,MAAMR,MAAM,GAAGC,YAAY,CAACC,OAAO,CAAC,cAAc,CAAC;EAG/C,IAAGF,MAAM,EACLJ,KAAK,CAACE,QAAQ,CAACK,OAAO,CAACC,MAAM,CAAC,eAAe,CAAC,GAAG,SAAS,GAACJ,MAAM,MAEjEH,MAAM,CAACY,IAAI,CAAC,GAAG,CAAC;EAExB,OAAOD,MAAM;AACf,CAAC,CAAC;AAEFZ,KAAK,CAACS,YAAY,CAACK,QAAQ,CAACH,GAAG,CAC5BG,QAAQ,IAAKA,QAAQ,EACtB,MAAOC,KAAK,IAAK;EACbC,OAAO,CAACC,GAAG,CAACF,KAAK,CAAC;EACtB,MAAMG,WAAW,GAAIC,kBAAkB,CAAC,CAAC;EACjCnB,KAAK,CAACE,QAAQ,CAACK,OAAO,CAACC,MAAM,CAAC,eAAe,CAAC,GAC5C,SAAS,GAAGU,WAAW;EACzB,OAAOlB,KAAK,CAACc,QAAQ,CAAC;AAGhC,CAAC,CAAC;;AAEJ;AACA;;AAGA;AACA;AACA;AACA;AACA;;AAGA,OAAO,MAAMK,kBAAkB,GAAG,MAAAA,CAAA,KAAY;EACtC,MAAMC,YAAY,GAAGf,YAAY,CAACC,OAAO,CAAC,eAAe,CAAC;EAC1D,MAAMe,IAAI,GAAG;IAAEC,OAAO,EAAEF;EAAa,CAAC;EAEtC,IAAI;IACF,MAAMN,QAAQ,GAAG,MAAMd,KAAK,CAACuB,IAAI,CAAC,6CAA6C,EAC7EF,IACF,CAAC;IACD,MAAMH,WAAW,GAAGJ,QAAQ,CAACO,IAAI,CAACjB,MAAM;IACxCC,YAAY,CAACmB,OAAO,CAAC,cAAc,EAAEN,WAAW,CAAC;IACjD,OAAOA,WAAW;EACpB,CAAC,CAAC,OAAOO,GAAG,EAAE;IAEZpB,YAAY,CAACqB,KAAK,CAAC,CAAC;IACpBzB,MAAM,CAACY,IAAI,CAAC,GAAG,CAAC;EAClB;AACF,CAAC;AAEP,MAAMc,KAAK,GAAGtB,YAAY,CAACC,OAAO,CAAC,cAAc,CAAC;AAE9C,IAAIqB,KAAK,EAAE;EACN3B,KAAK,CAACE,QAAQ,CAACK,OAAO,CAACC,MAAM,CAAC,eAAe,CAAC,GAAG,SAAS,GAACmB,KAAK;AACrE,CAAC,MACG;EACA1B,MAAM,CAACY,IAAI,CAAC,GAAG,CAAC;AAClB;;AAEN;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;;AAGA;;AAGA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEE,eAAeb,KAAK"},"metadata":{},"sourceType":"module","externalDependencies":[]}